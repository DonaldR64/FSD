<input type="hidden" class="sheet-tabstoggle" name="attr_sheetTab"  value="display"  />
<div>
    <button type="action" name="act_input" >Input</button>
    <button type="action" name="act_display" >Display</button>
    <button type="action" name="act_abilities" >Special Rules</button>
</div>

<div class="sheet-input">
    <div class="2colrow">
        <div class="col">
            <h3>Unit Information</h3>
            <label>Name:</label><input type="text" name="attr_character_name">
            <br>
            <label for="attr_type">Type:</label>
            <select name="attr_type">
                <option value="" selected disabled hidden>Choose here</option>
                <option value="Infantry">Infantry</option>
                <option value="Vehicle">Vehicle</option>
                <option value="Walker">Walker</option>
                <option value="Air">Air</option>
            </select>
            <br>
            <label>Class:</label><input type="number" name="attr_class">
            <br>
            <label for="attr_faction">Faction:</label>
            <select name="attr_faction">
                <option value="" selected disabled hidden>Choose here</option>
                <option value="Syndicate">Syndicate</option>
                <option value="Consortium">Consortium</option>
               
            </select>



        </div>
        <div class="col">
            <h3>Max Attributes</h3>
            <label>Mobility:</label><input type="number" name="attr_mobility_max">
            <br>
            <label>Firepower:</label><input type="number" name="attr_fp_max">
            <br>
            <label>Armour:</label><input type="number" name="attr_armour_max">
            <br>
            <label>Defence:</label><input type="number" name="attr_defence_max">

        </div>
    </div>    


    <div class="row">            
            <h3>Abilities</h3>
            <input type="text" name="attr_abilities">
    </div>
    <div class="row">
            <h3>Weapons</h3>
            <table>
            <thead>
                <tr>
                    <th>Weapon</th>
                    <th>Abilities</th>
                    <th>F/X</th>
                    <th>Sound</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><input type="text" name="attr_weapon1name"></td>
                    <td><input type="text" name="attr_weapon1abilities"></td>
                    <td><input type="text" name="attr_weapon1fx"></td>
                    <td><input type="text" name="attr_weapon1sound"></td>                
                </tr>
                <tr>
                    <td><input type="text" name="attr_weapon2name"></td>
                    <td><input type="text" name="attr_weapon2abilities"></td>
                    <td><input type="text" name="attr_weapon2fx"></td>
                    <td><input type="text" name="attr_weapon2sound"></td>                
                </tr>
                <tr>
                    <td><input type="text" name="attr_weapon3name"></td>
                    <td><input type="text" name="attr_weapon3abilities"></td>
                    <td><input type="text" name="attr_weapon3fx"></td>
                    <td><input type="text" name="attr_weapon3sound"></td>                
                </tr>
            </tbody>
            </table>
    </div>



</div>



<div class="sheet-display">
    <input type="hidden" name="attr_faction"/>
    <div class="mysheet">
      <div class="bits">
        <main>
          <section class="header">
                <h1><span name="attr_character_name"></span></h1>   
                <h3><span>Class </span><span name="attr_class"></span> - <span name="attr_type"></span></h3>
                <h3><span name="attr_faction"></span></h3>
          </section>



          <section class="common">
              <img alt="Character Avatar" name="attr_character_avatar" style="width:600px;height:auto; bottom: 0;"/>
          </section>

            <section class="attr">
                <h2>Stat</h2>
                <h2>Value</h2>
                <h3>Mobility: </h3>
                <h3><span name="attr_mobpic"></span></h3>
                <h3>Firepower: </h3>
                <h3><span name="attr_fppic"></span></h3>
                <h3>Armour: </h3>                
                <h3><span name="attr_armpic"></span></h3>
                <h3>Defence: </h3>                
                <h3><span name="attr_defpic"></span></h3>
=            </section>

        <section class="weap f-col">
                <h2>Weapon</h2>
                <h2>Abilities</h2>
                <h3><span name="attr_weapon1name"></span></h3>
                <h3><span name="attr_weapon1abilities"></span></h3>
                <h3><span name="attr_weapon2name"></span></h3>
                <h3><span name="attr_weapon2abilities"></span></h3>
                <h3><span name="attr_weapon3name"></span></h3>
                <h3><span name="attr_weapon3abilities"></span></h3>
        </section>

        <section class="ab f-col">
            <h2>Abilities</h2>
            <h3><span name="attr_abilities"></span></h3>
          </section>

        </main>
      </div>
    </div>    
</div>

<div class="sheet-abilities">
    <input type="hidden" name="attr_nation"/>
    <div class="mysheet">
        <div class="bits">
            <input type="hidden" name="attr_nation"/>
            <div class="spheader">
                <h2>Special Rules</h2>
                <br>
            </div>
            <input type="hidden" name="attr_nation"/>
            <div class="spbody">
                <div class = "item">
                    <span style="font-weight:bold;" name="attr_spec1Name"></span>
                    <span name="attr_spec1Text"></span>
                </div>
                <div class = "item">
                    <span style="font-weight:bold;" name="attr_spec2Name"></span>
                    <span name="attr_spec2Text"></span>
                </div>
                <div class = "item">
                    <span style="font-weight:bold;" name="attr_spec3Name"></span>
                    <span name="attr_spec3Text"></span>
                </div>
                <div class = "item">                
                    <span style="font-weight:bold;" name="attr_spec4Name"></span>
                    <span name="attr_spec4Text"></span>
                </div>
                <div class = "item">                                
                    <span style="font-weight:bold;" name="attr_spec5Name"></span>
                    <span name="attr_spec5Text"></span>
                </div>
                <div class = "item">                
                    <span style="font-weight:bold;" name="attr_spec6Name"></span>
                    <span name="attr_spec6Text"></span>
                </div>
                <div class = "item">                
                    <span style="font-weight:bold;" name="attr_spec7Name"></span>
                    <span name="attr_spec7Text"></span>
                </div>
                <div class = "item">                
                    <span style="font-weight:bold;" name="attr_spec8Name"></span>
                    <span name="attr_spec8Text"></span>
                </div>
                <div class = "item">                
                    <span style="font-weight:bold;" name="attr_spec9Name"></span>
                    <span name="attr_spec9Text"></span>
                </div>
                <div class = "item">                
                    <span style="font-weight:bold;" name="attr_spec10Name"></span>
                    <span name="attr_spec10Text"></span>
                </div>
            </div>
        </div>
    </div>
</div>



<script type="text/worker">
    const buttonlist = ["input","display","abilities"];
    buttonlist.forEach(button => {
        on(`clicked:${button}`, function() {
            setAttrs({
                sheetTab: button
            });
        });
    });


    on("sheet:opened", function() {
        setAttrs({sheetTab:"display"});
    });


 on("change:attrs sheet:opened", function() { 
        getAttrs(["mobility","mobility_max","fp","fp_max","armour","armour_max","defence","defence_max"], function(values) {
            let mobility = parseInt(values.mobility);
            let mobilityMax = parseInt(values.mobility_max);
            let fp = parseInt(values.fp);
            let fpMax = parseInt(values.fp_max);
            let armour = parseInt(values.armour);
            let armourMax = parseInt(values.armour_max);
            let defence = parseInt(values.defence);
            let defenceMax = parseInt(values.defence_max);

            let mobpic = "";
            let fppic = "";
            let armpic = "";
            let defpic = "";

            for (let i=0;i<mobilityMax;i++) {
                if (i<mobility) {
                    mobpic += "◉";
                } else {
                    mobpic += "○";
                }
            }
            for (let i=0;i<fpMax;i++) {
                if (i<fp) {
                    fppic += "◉";
                } else {
                    fppic += "○";
                }
            }
            for (let i=0;i<armourMax;i++) {
                if (i<armour) {
                    armpic += "◉";
                } else {
                    armpic += "○";
                }
            }
            for (let i=0;i<defenceMax;i++) {
                if (i<defence) {
                    defpic += "◉";
                } else {
                    defpic += "○";
                }
            }




            setAttrs({
                "mobpic": mobpic,
                "fppic": fppic,
                "armpic": armpic,
                "defpic": defpic,


            });
        });    
    }); 


</script>
